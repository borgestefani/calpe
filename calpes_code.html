<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CALPE – Calculadora de Leiturabilidade</title>
  <style>
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif;background:#0f172a;color:#e5e7eb}
    .wrap{max-width:900px;margin:40px auto;padding:20px}
    h1{margin:0 0 8px}
    textarea{width:100%;min-height:220px;padding:12px;border-radius:10px;border:1px solid #243244;background:#1f2937;color:#e5e7eb}
    button{margin-top:10px;padding:10px 14px;border:0;border-radius:10px;background:#22c55e;color:#06210e;font-weight:700;cursor:pointer}
    .card{margin-top:16px;padding:14px;border-radius:12px;border:1px solid #223047;background:#111827}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width: 700px){.row{grid-template-columns:1fr}}
    .stat{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px dashed rgba(255,255,255,.12)}
    .stat:last-child{border-bottom:0}
    .score{font-size:36px;font-weight:800}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>CALPE – Calculadora de Leiturabilidade</h1>
    <p>Cole o texto abaixo e clique em <strong>Calcular</strong>.</p>

    <textarea id="text" placeholder="Cole aqui o texto a avaliar..."></textarea>
    <button id="calc">Calcular</button>

    <div class="row">
      <div class="card">
        <h3>Contagens</h3>
        <div class="stat"><span>Frases</span><strong id="sentencesOut">–</strong></div>
        <div class="stat"><span>Palavras</span><strong id="wordsOut">–</strong></div>
        <div class="stat"><span>Sílabas</span><strong id="syllablesOut">–</strong></div>
      </div>
      <div class="card">
        <h3>Resultado</h3>
        <div>Índice de Flesch (pt-BR)</div>
        <div class="score" id="scoreOut">–</div>
        <div id="classOut">–</div>
      </div>
    </div>
  </div>

  <script>
    const WORD_RE = /[A-Za-zÀ-ÖØ-öø-ÿ]+(?:['’-][A-Za-zÀ-ÖØ-öø-ÿ]+)*/g;
    const VOWEL_GROUPS = /[aeiouáéíóúâêôãõàü]+/gi;

    function countSentences(t){
      const s=(t||"").replace(/\.{3,}/g,".");
      const parts=s.split(/[.!?;:]+/).map(x=>x.trim()).filter(Boolean);
      return Math.max(1, parts.length);
    }
    function countWords(t){
      const m=(t||"").match(WORD_RE);
      return m? m.length: 0;
    }
    function syllablesInWord(w){
      if(!w) return 0;
      const lower=w.toLowerCase();
      const groups=lower.match(VOWEL_GROUPS);
      let syl=groups? groups.length: 0;
      if(/g[uü]e|g[uü]i|q[uü]e|q[uü]i/.test(lower)) syl -= 1;
      if(/ai|ei|oi|ui|au|eu|ou|ão|ãe/.test(lower)) syl -= 0.5;
      return Math.round(Math.max(1, syl));
    }
    function countSyllables(t){
      const words=(t||"").match(WORD_RE)||[];
      return words.reduce((s,w)=> s+syllablesInWord(w), 0);
    }
    function classify(score){
      if(score>=75) return "Muito fácil (fundamental)";
      if(score>=50) return "Fácil (fundamental/médio)";
      if(score>=25) return "Difícil (médio/superior)";
      return "Muito difícil (superior)";
    }

    document.getElementById('calc').addEventListener('click', ()=>{
      const text=document.getElementById('text').value;
      const sentences=countSentences(text);
      const words=countWords(text);
      const syllables=countSyllables(text);
      const wps=words/sentences;
      const spw=syllables/words || 0;
      const score=248.835 - 1.015*wps - 84.6*spw;

      document.getElementById('sentencesOut').textContent=sentences;
      document.getElementById('wordsOut').textContent=words;
      document.getElementById('syllablesOut').textContent=syllables;
      document.getElementById('scoreOut').textContent=isFinite(score)? score.toFixed(1): "–";
      document.getElementById('classOut').textContent=isFinite(score)? classify(score): "–";
    });
  </script>
</body>
</html>

