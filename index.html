<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CALPES – Calculadora de Leiturabilidade</title>
  <meta name="description" content="CALPES – Calculadora de Leiturabilidade em Português para Materiais Educativos em Saúde." />
  <style>
  /* ===== Paleta (light) ===== */
  :root{
    --bg-grad: linear-gradient(to bottom, #ffffff, #e5e7eb);
    --text: #111827;      /* texto principal (quase preto)   */
    --muted: #374151;     /* legendas/dicas (cinza escuro)   */
    --card: #ffffff;      /* fundo dos cards                 */
    --border: rgba(17,24,39,.12); /* borda sutil               */
    --accent: #16a34a;    /* botão principal (verde elegante)*/
    --soft: #0f172a;      /* campos/textarea escuros         */
  }

  *{box-sizing:border-box}

  body{
    margin:0;
    background: var(--bg-grad);
    font-family: Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;
    color: var(--text);
  }

  .wrap{max-width:1000px;margin:32px auto;padding:24px}

  .title{font-size:clamp(24px,3vw,36px);font-weight:800;letter-spacing:-.02em}
  .subtitle{color:var(--muted);margin-top:6px}

  .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:16px;margin-top:20px}
  @media (max-width: 900px){.grid{grid-template-columns:1fr}}

  /* Cards ajustados para light */
  .card{
    background: var(--card);
    border: 1px solid var(--border);
    border-radius:16px;
    box-shadow: 0 8px 24px rgba(0,0,0,.08);
  }
  .card h2{font-size:18px;margin:0 0 12px}

  .pad{padding:18px}

  /* Área de texto e inputs */
  textarea{
  width:100%;min-height:320px;
  background: var(--soft);
  color:#e5e7eb;
  border:1px solid rgba(0,0,0,.12);
  border-radius:12px;padding:14px;resize:vertical;font-size:15px;line-height:1.5
}

input[type="number"]{
  width:100%;padding:10px;border-radius:10px;
  border:1px solid rgba(0,0,0,.12);
  background: var(--soft);color:#e5e7eb
}

  .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}

  /* Botões */
  button{
    appearance:none;border:0;border-radius:12px;padding:12px 14px;
    background: var(--accent);color:#ffffff;font-weight:700;cursor:pointer
  }
  button.secondary{
    background:transparent;color:var(--text);
    border:1px solid var(--border)
  }

  .muted{color:var(--muted)}

  /* Linhas da lista de resultados */
  .stat{
    display:grid;grid-template-columns:1fr auto;gap:6px;padding:10px 0;
    border-bottom:1px dashed var(--border)
  }
  .stat:last-child{border-bottom:0}

  .score{font-size:56px;font-weight:900;letter-spacing:-.03em}
  .badge{display:inline-block;padding:6px 10px;border-radius:999px;
         background:#f3f4f6;border:1px solid var(--border);font-size:12px;color:var(--text)}
  .foot{font-size:12px;color:var(--muted)}
  .small{font-size:13px}
  .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}

  .link{color:#2563eb;text-decoration:none}
</style>

</head>
<body>
  <div class="wrap">
    <div class="title">CALPES <span class="badge">beta</span></div>
    <div class="subtitle">Calculadora de Leiturabilidade em Português para Materiais Educativos em Saúde</div>

    <div class="grid">
      <div class="card pad">
        <h2>Texto</h2>
        <textarea id="text" placeholder="Cole o texto para avaliação aqui..."></textarea>
        <div class="row help">
          <button id="calc">Calcular</button>
          <button class="secondary" id="clear">Limpar</button>
          <span class="muted small">Dica: você pode também informar contagens manualmente abaixo (sobrepõe a detecção automática).</span>
        </div>
        <div class="inputs" style="margin-top:12px">
          <div>
            <label class="small muted">Frases</label>
            <input id="sentencesManual" type="number" min="0" placeholder="auto" />
          </div>
          <div>
            <label class="small muted">Palavras</label>
            <input id="wordsManual" type="number" min="0" placeholder="auto" />
          </div>
          <div>
            <label class="small muted">Sílabas</label>
            <input id="syllablesManual" type="number" min="0" placeholder="auto" />
          </div>
        </div>
        <p class="foot">O cálculo de sílabas é feito de forma aproximada, considerando as vogais. Para textos técnicos, prefira validar com amostras manuais.</p>
      </div>

      <div class="card pad">
        <h2>Resultados</h2>
        <div class="stat"><span class="muted">Frases</span><strong id="sentencesOut">–</strong></div>
        <div class="stat"><span class="muted">Palavras</span><strong id="wordsOut">–</strong></div>
        <div class="stat"><span class="muted">Sílabas</span><strong id="syllablesOut">–</strong></div>
        <div class="stat"><span class="muted">Média de sílabas por palavra</span><strong id="spwOut">–</strong></div>
        <div class="stat"><span class="muted">Média de palavras por frase</span><strong id="wpsOut">–</strong></div>
        <div style="margin:16px 0;border-top:1px solid rgba(255,255,255,.1)"></div>
        <div class="muted small">Índice de Leiturabilidade de Flesch (Português)</div>
        <div class="score" id="scoreOut">–</div>
        <div class="badge" id="classOut">–</div>
        <div class="foot" style="margin-top:10px">
  <div style="margin-bottom:6px;">Interpretação sugerida:</div>
  <table style="width:100%; border-collapse: collapse; font-size:13px; text-align:left;">
    <tr style="background:rgba(34,197,94,0.08);">
      <td style="padding:6px;">>75–100</td>
      <td style="padding:6px;">Muito fácil (nível fundamental, 1º ao 5º ano)</td>
    </tr>
    <tr style="background:rgba(132,204,22,0.08);">
      <td style="padding:6px;">>50–75</td>
      <td style="padding:6px;">Fácil (nível fundamental, 6º ao 9º ano)</td>
    </tr>
    <tr style="background:rgba(251,191,36,0.08);">
      <td style="padding:6px;">>25–50</td>
      <td style="padding:6px;">Difícil (nível médio)</td>
    </tr>
    <tr style="background:rgba(239,68,68,0.08);">
      <td style="padding:6px;">0–25</td>
      <td style="padding:6px;">Muito difícil (nível superior)</td>
    </tr>
  </table>
</div>
</div>
     <div class="card pad" style="margin-top:10px">
      <div class="row">
        <button id="downloadXlsx" class="secondary">Baixar resultados (.xlsx)</button>
        <button id="copy" class="secondary">Copiar resumo</button>
      </div>
    </div>
<div class="card pad" style="margin-top:10px; text-align:center;">
  <h2>Conecte-se</h2>
  <p class="small muted">Saiba mais sobre meu trabalho:</p>
  
  <!-- Ícones sociais -->
  <div style="display:flex; justify-content:center; gap:20px; margin-top:10px;">
    
   <!-- Lattes -->
<a href="https://lattes.cnpq.br/6753755414872565" target="_blank" 
   style="text-decoration:none; display:flex; flex-direction:column; align-items:center;">
  <img src="https://lh5.googleusercontent.com/proxy/4d6-dVOcMrp7HoU9t-bhgfgoqSLWbcgosoSMPp956YzTQzTfRfFDiUXR3hssFIJDTEe0ozmcq4wv6E7AiZn7-kNEwVvhboggb9gHgMMh-webTRvzg8ndDb7Sffpa9N2N4ThiQboH11-KkcPt_C4Qj0ZXxeEREqmIp7k" 
       alt="Lattes" width="36" height="36" style="border-radius:6px;" />
  <div style="font-size:13px; margin-top:4px; color:var(--muted);">Lattes</div>
</a>
    
    <!-- LinkedIn -->
    <a href="https://www.linkedin.com/in/stefaniboorges/" target="_blank" 
       style="text-decoration:none;">
      <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" 
           viewBox="0 0 24 24" fill="#0a66c2">
        <path d="M19 0h-14c-2.76 0-5 2.24-5 5v14c0 
                 2.76 2.24 5 5 5h14c2.76 0 5-2.24 
                 5-5v-14c0-2.76-2.24-5-5-5zm-11 
                 19h-3v-10h3v10zm-1.5-11.4c-.97 
                 0-1.75-.79-1.75-1.75s.78-1.75 
                 1.75-1.75 1.75.79 
                 1.75 1.75-.78 1.75-1.75 
                 1.75zm13.5 11.4h-3v-5.6c0-1.34-.03-3.06-1.87-3.06-1.87 
                 0-2.16 1.46-2.16 2.96v5.7h-3v-10h2.88v1.37h.04c.4-.76 
                 1.38-1.56 2.84-1.56 3.04 0 3.6 2 
                 3.6 4.59v5.6z"/>
      </svg>
      <div style="font-size:13px; margin-top:4px; color:var(--muted);">LinkedIn</div>
    </a>
    
  </div>
</div>

    <p class="foot" style="margin-top:15px">© 2025 CALPES · Licença MIT · Esta é uma ferramenta educacional.</p>
  </div>

  <!-- Biblioteca para gerar Excel -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.19.3/dist/xlsx.full.min.js"></script>

  <script>
    const VOWEL_GROUPS = /[aeiouáéíóúâêôãõàü]+/gi;
    const WORD_RE = /[A-Za-zÀ-ÖØ-öø-ÿ]+(?:['’-][A-Za-zÀ-ÖØ-öø-ÿ]+)*/g;

    function countSentences(text){
      const s = (text||"").replace(/\.{3,}/g, ".");
      const pieces = s.split(/[.!?;:]+/).map(t=>t.trim()).filter(Boolean);
      return Math.max(1, pieces.length);
    }
    function countWords(text){
      const m = (text||"").match(WORD_RE);
      return m ? m.length : 0;
    }
    function syllablesInWord(w){
      if(!w) return 0;
      const lower = w.toLowerCase();
      const groups = lower.match(VOWEL_GROUPS);
      let syl = groups ? groups.length : 0;
      if(/g[uü]e|g[uü]i|q[uü]e|q[uü]i/.test(lower)) syl -= 1;
      if(/ai|ei|oi|ui|au|eu|ou|ão|ãe/.test(lower)) syl -= 0.5;
      return Math.round(Math.max(1, syl));
    }
    function countSyllables(text){
      const words = (text||"").match(WORD_RE) || [];
      return words.reduce((sum,w)=> sum + syllablesInWord(w), 0);
    }
    function classify(score){
      if(score >= 75) return "Muito fácil (fundamental)";
      if(score >= 50) return "Fácil (fundamental/médio)";
      if(score >= 25) return "Difícil (médio/superior)";
      return "Muito difícil (superior)";
    }

    function compute(){
      const text = document.getElementById('text').value;
      const sManual = parseInt(document.getElementById('sentencesManual').value,10);
      const wManual = parseInt(document.getElementById('wordsManual').value,10);
      const yManual = parseInt(document.getElementById('syllablesManual').value,10);

      let sentences = Number.isFinite(sManual) ? sManual : countSentences(text);
      let words = Number.isFinite(wManual) ? wManual : countWords(text);
      let syllables = Number.isFinite(yManual) ? yManual : countSyllables(text);

      sentences = Math.max(1, sentences);
      words = Math.max(1, words);
      syllables = Math.max(1, syllables);

      const wps = words / sentences;
      const spw = words ? (syllables / words) : 0;
      const score = 248.835 - 1.015 * wps - 84.6 * spw;

      document.getElementById('sentencesOut').textContent = sentences;
      document.getElementById('wordsOut').textContent = words;
      document.getElementById('syllablesOut').textContent = syllables;
      document.getElementById('wpsOut').textContent = wps.toFixed(2);
      document.getElementById('spwOut').textContent = spw.toFixed(2);
      document.getElementById('scoreOut').textContent = isFinite(score) ? score.toFixed(1) : "–";
      document.getElementById('classOut').textContent = classify(score);

      window.__lastResult = { sentences, words, syllables, wps, spw, score, classification: classify(score) };
    }

    // Exportar como Excel (.xlsx)
    function downloadAsXlsx() {
      if (!window.__lastResult) {
        alert('Calcule primeiro para gerar o arquivo.');
        return;
      }
      const r = window.__lastResult;

      // Aba 1: Resultados
      const resultados = [
        ['Campo', 'Valor'],
        ['Frases', r.sentences],
        ['Palavras', r.words],
        ['Sílabas', r.syllables],
        ['Palavras por frase (wps)', Number(r.wps).toFixed(2)],
        ['Sílabas por palavra (spw)', Number(r.spw).toFixed(2)],
        ['Índice de Flesch (pt-BR)', Number(r.score).toFixed(1)],
        ['Classificação', r.classification],
        ['Gerado em', new Date().toISOString()]
      ];
      const wsResultados = XLSX.utils.aoa_to_sheet(resultados);

      // Aba 2: Texto (para referência)
      const texto = document.getElementById('text').value || '';
      const wsTexto = XLSX.utils.aoa_to_sheet([['Texto avaliado'], [texto]]);

      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, wsResultados, 'Resultados');
      XLSX.utils.book_append_sheet(wb, wsTexto, 'Texto');

      XLSX.writeFile(wb, 'calpes_resultados.xlsx');
    }

    document.getElementById('calc').addEventListener('click', compute);
    document.getElementById('clear').addEventListener('click', ()=>{
      document.getElementById('text').value = '';
      ['sentencesOut','wordsOut','syllablesOut','wpsOut','spwOut','scoreOut','classOut'].forEach(id=>{
        document.getElementById(id).textContent = '–';
      });
      window.__lastResult = null;
    });
    document.getElementById('downloadXlsx').addEventListener('click', downloadAsXlsx);

    document.getElementById('copy').addEventListener('click', ()=>{
      const r = window.__lastResult;
      const text = r
        ? `Índice de Flesch (pt-BR): ${Number(r.score).toFixed(1)} — ${r.classification}\nFrases: ${r.sentences} | Palavras: ${r.words} | Sílabas: ${r.syllables}\nMédias: ${Number(r.wps).toFixed(2)} palavras/frase; ${Number(r.spw).toFixed(2)} sílabas/palavra`
        : 'Sem resultados ainda.';
      navigator.clipboard.writeText(text);
    });
  </script>
</body>
</html>

